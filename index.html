<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Instagram List Cleaner</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <h1>âœ¨ Instagram Username Cleaner âœ¨</h1>

  <div class="input-group">
    <label for="followersInput">Paste Followers List:</label>
    <textarea id="followersInput" placeholder="Paste followers list here..."></textarea>
  </div>

  <div class="input-group">
    <label for="followingInput">Paste Following List:</label>
    <textarea id="followingInput" placeholder="Paste following list here..."></textarea>
  </div>

  <button onclick="compareLists()">Compare</button>
  <div id="loader" class="loader">Scanning... Beep boop ðŸ¤–</div>

  <div class="results-grid">
    <div class="result-column">
      <h3>ðŸ‘€ They follow you, but you donâ€™t follow back</h3>
      <div class="scroll-box" id="youDontFollowBack"></div>
    </div>

    <div class="result-column">
      <h3>ðŸš« You follow them, but they donâ€™t follow you back</h3>
      <div class="scroll-box" id="notFollowingBack"></div>
    </div>

    <div class="result-column">
      <h3>âœ… Mutuals (follow each other)</h3>
      <div class="scroll-box" id="mutuals"></div>
    </div>
  </div>

  <button onclick="toggleInvalids()" id="toggleInvalidBtn">ðŸ§¹ Show Swept Junk</button>

  <div id="invalidSection" style="display: none;">
    <h3>ðŸ§¹ Entries we swept under the digital rug</h3>
    <p class="note">We cleaned your lists to only reflect real usernames. Here's the junk we filtered out:</p>
    <div class="scroll-box" id="invalidEntries"></div>
  </div>

  <script>
    function isValidUsername(str) {
      return /^[a-z0-9._]{1,30}$/.test(str.trim());
    }

    function extractValidLines(rawText, invalidCollector) {
      const lines = rawText.split('\n').map(line => line.trim());
      const valid = [];
      const invalid = [];

      for (let line of lines) {
        if (line && isValidUsername(line)) {
          valid.push(line);
        } else if (line) {
          invalid.push(line);
        }
      }

      if (invalidCollector) invalidCollector.push(...invalid);
      return [...new Set(valid)];
    }

    function displayList(id, usernames) {
      const el = document.getElementById(id);
      el.innerHTML = usernames.length
        ? usernames.map(u => `<a href="https://instagram.com/${u}" target="_blank">${u}</a>`).join('<br>')
        : '<span class="empty">None</span>';
    }

    function compareLists() {
      const loader = document.getElementById('loader');
      loader.style.display = 'block';

      setTimeout(() => {
        const invalid = [];
        const followers = extractValidLines(document.getElementById('followersInput').value, invalid);
        const following = extractValidLines(document.getElementById('followingInput').value, invalid);

        const mutuals = followers.filter(u => following.includes(u));
        const notFollowingBack = following.filter(u => !followers.includes(u));
        const youDontFollowBack = followers.filter(u => !following.includes(u));

        displayList('mutuals', mutuals);
        displayList('notFollowingBack', notFollowingBack);
        displayList('youDontFollowBack', youDontFollowBack);
        displayList('invalidEntries', [...new Set(invalid)]);

        loader.style.display = 'none';
      }, 800);
    }

    function toggleInvalids() {
      const section = document.getElementById('invalidSection');
      const btn = document.getElementById('toggleInvalidBtn');
      const visible = section.style.display === 'block';
      section.style.display = visible ? 'none' : 'block';
      btn.textContent = visible ? 'ðŸ§¹ Show Swept Junk' : 'ðŸ™ˆ Hide Swept Junk';
    }
  </script>
</body>
</html>